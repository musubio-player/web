<!--
An element for fetching Musubio channels

Example:

    <channel-details></channel-details>

@element channel-details
-->
<dom-module id="channel-details">
  <template>
    <iron-ajax
      auto
      url="{{apiHost}}/_ah/api/musubio/v1/channels/{{channelId}}"
      handle-as="json"
      on-response="responseChannel"
      last-response="{{channel}}">
    </iron-ajax>

    <iframe
        width="800"
        height="450"
        src="https://www.youtube.com/embed/{{currentVideo.video_id}}?rel=0&amp;showinfo=0&autoplay=1&controls=1&start={{videoStartTime}}"
        frameborder="0"
        allowfullscreen>
    </iframe>

    <div class="current-video">
      <h1>{{currentVideo.title}}</h1>
      <div>{{currentVideo.description}}</div>
    </div>

    <div class="channel-info">
      <h3>{{channel.title}}</h3>
      <div>{{channel.description}}</div>
    </div>

    <h2>Playlist</h2>
    <template class="playlist" is="dom-repeat" items="{{channel.videos}}" as="video">
      <img src="{{video.image.medium}}">
    </template>
    <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />

  </template>
</dom-module>

<script>
  Polymer({
    is: 'channel-details',
    properties: {
      apiHost: {
        type: String,
        value: musubioApiHost
      },
      videoStartTime: {
        type: Number,
        value: Math.floor(Math.random() * (300 - 1) + 1)
      },
      currentVideoId: {
        type: String
      }
    },
    responseChannel: function(request) {
      var channel = request.detail.response;
      var videos = channel.videos;
      var randomIndex = Math.floor(Math.random() * (videos.length - 0) + 0);
      this.currentVideo = videos[randomIndex];
    }
  });

</script>